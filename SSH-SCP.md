# เอกสารคำสั่ง SCP (Secure Copy Protocol)

### การอัปโหลด (จากเครื่องในเครือข่ายไปยังเครื่องระยะไกล)
```
scp [ตัวเลือก] ไฟล์ต้นทาง ชื่อผู้ใช้@เครื่องระยะไกล:เส้นทางปลายทาง
```

### การดาวน์โหลด (จากเครื่องระยะไกลมายังเครื่องในเครือข่าย)
```
scp [ตัวเลือก] ชื่อผู้ใช้@เครื่องระยะไกล:ไฟล์ต้นทาง เส้นทางปลายทาง
```

## ตัวเลือกที่ใช้บ่อย

| ตัวเลือก | คำอธิบาย |
|--------|-------------|
| `-P port` | ระบุพอร์ตที่จะเชื่อมต่อกับเครื่องระยะไกล |
| `-r` | คัดลอกไดเรกทอรีทั้งหมดแบบเรียกซ้ำ (recursively) |
| `-p` | รักษาเวลาแก้ไข เวลาเข้าถึง และโหมดจากไฟล์ต้นฉบับ |
| `-q` | โหมดเงียบ ปิดการแสดงความคืบหน้าและข้อความเตือน/วินิจฉัย |
| `-C` | เปิดใช้การบีบอัด |
| `-l limit` | จำกัดแบนด์วิดธ์ ระบุเป็น Kbit/s |
| `-i identity_file` | เลือกไฟล์ที่มีข้อมูลตัวตน (private key) สำหรับการตรวจสอบสิทธิ์ด้วย public key |

## ตัวอย่าง

### การอัปโหลดไฟล์

1. **การอัปโหลดพื้นฐาน**:
   ```
   scp fileName.txt user@remotehost:/home/username/destination/fileName.txt
   ```
   อัปโหลดไฟล์ `fileName.txt` ไปยังปลายทางที่ระบุบนเซิร์ฟเวอร์ระยะไกล

2. **การอัปโหลดด้วยพอร์ตที่กำหนดเอง**:
   ```
   scp -P 2222 sample3.txt test_user@10.0.10.5:/home/test/sample3.txt
   ```
   อัปโหลดไฟล์ `sample3.txt` ไปยังเซิร์ฟเวอร์ระยะไกลโดยใช้พอร์ต 2222

3. **การอัปโหลดไดเรกทอรี**:
   ```
   scp -r local_directory user@remotehost:/home/username/destination/
   ```
   อัปโหลดไดเรกทอรีทั้งหมดแบบเรียกซ้ำไปยังเซิร์ฟเวอร์ระยะไกล

### การดาวน์โหลดไฟล์

1. **การดาวน์โหลดพื้นฐาน**:
   ```
   scp usr@10.X.X.X:/home/usr/data/*.* .
   ```
   ดาวน์โหลดไฟล์ทั้งหมดจากไดเรกทอรีระยะไกลมายังไดเรกทอรีปัจจุบันในเครื่องท้องถิ่น

2. **การดาวน์โหลดด้วยพอร์ตที่กำหนดเอง**:
   ```
   scp -P 2222 usr@10.X.X.X:/home/usr/data/*.* .
   ```
   ดาวน์โหลดไฟล์ทั้งหมดจากไดเรกทอรีระยะไกลโดยใช้พอร์ต 2222

3. **การดาวน์โหลดไฟล์เฉพาะ**:
   ```
   scp user@remote:/path/to/file.txt /local/directory/
   ```
   ดาวน์โหลดไฟล์เฉพาะจากเซิร์ฟเวอร์ระยะไกลมายังไดเรกทอรีท้องถิ่น

4. **การดาวน์โหลดไดเรกทอรี**:
   ```
   scp -r user@remote:/path/to/directory/ /local/destination/
   ```
   ดาวน์โหลดไดเรกทอรีทั้งหมดแบบเรียกซ้ำจากเซิร์ฟเวอร์ระยะไกล

## เคล็ดลับและแนวทางปฏิบัติที่ดี

1. **ใช้การตรวจสอบสิทธิ์ด้วย Public Key**:
   ตั้งค่า SSH keys เพื่อหลีกเลี่ยงการพิมพ์รหัสผ่านซ้ำๆ
   ```
   scp -i ~/.ssh/private_key file.txt user@remote:/destination/
   ```

2. **บีบอัดไฟล์เพื่อการถ่ายโอนที่เร็วขึ้น**:
   ใช้ตัวเลือก `-C` เพื่อเปิดใช้การบีบอัด
   ```
   scp -C large_file.dat user@remote:/destination/
   ```

3. **จำกัดแบนด์วิดธ์**:
   ใช้ตัวเลือก `-l` เพื่อจำกัดการใช้แบนด์วิดธ์
   ```
   scp -l 1000 large_file.dat user@remote:/destination/
   ```
   นี่จะจำกัดการถ่ายโอนที่ 1000 Kbit/s

4. **รักษาคุณลักษณะของไฟล์**:
   ใช้ตัวเลือก `-p` เพื่อรักษาเวลาและสิทธิ์
   ```
   scp -p important_file.txt user@remote:/destination/
   ```

5. **โหมดเงียบ**:
   ใช้ตัวเลือก `-q` เพื่อระงับข้อความที่ไม่ใช่ข้อผิดพลาด
   ```
   scp -q file.txt user@remote:/destination/
   ```

6. **หลายไฟล์**:
   คุณสามารถระบุไฟล์ต้นทางหลายไฟล์ได้:
   ```
   scp file1.txt file2.txt user@remote:/destination/
   ```

7. **การหลีกเลี่ยงอักขระพิเศษ**:
   หากชื่อไฟล์หรือเส้นทางมีช่องว่างหรืออักขระพิเศษ ให้ใช้เครื่องหมายคำพูด:
   ```
   scp "file with spaces.txt" user@remote:"/path/with spaces/"
   ```

## การแก้ไขปัญหา

1. **ปัญหาการเชื่อมต่อ**:
   - ตรวจสอบว่าสามารถเข้าถึงเครื่องระยะไกลได้ (ลอง `ping` หรือ `ssh`)
   - ตรวจสอบว่าบริการ SSH กำลังทำงานบนเครื่องระยะไกล
   - ตรวจสอบว่าพอร์ตถูกต้องและเปิดอยู่

2. **ปัญหาสิทธิ์**:
   - ตรวจสอบว่าคุณมีสิทธิ์อ่านสำหรับไฟล์ต้นทาง
   - ตรวจสอบว่าคุณมีสิทธิ์เขียนสำหรับไดเรกทอรีปลายทาง
   - ตรวจสอบความเป็นเจ้าของไฟล์และสิทธิ์ด้วย `ls -la`

3. **ปัญหาการตรวจสอบสิทธิ์**:
   - ตรวจสอบว่าชื่อผู้ใช้ถูกต้อง
   - ตรวจสอบว่า SSH key ของคุณตั้งค่าถูกต้อง (หากใช้การตรวจสอบสิทธิ์ด้วย key)
   - ลองใช้โหมด verbose (`-v`) เพื่อดูข้อมูลการเชื่อมต่อโดยละเอียด:
     ```
     scp -v file.txt user@remote:/destination/
     ```